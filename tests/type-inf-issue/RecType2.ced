module RecType2(F : (â˜… â” â˜…) â” â˜… â” â˜…).

import top.
import cast2.

RecFunctor2 â—‚ â˜… =
  âˆ€ X : ğ’Œ . âˆ€ Y : ğ’Œ . Cast2 Â· X Â· Y â” Cast2 Â· (F Â· X) Â· (F Â· Y) .

Rec2 â—‚ ğ’Œ = Î» Y : â˜… . âˆ€ X : ğ’Œ . Cast2 Â· (F Â· X) Â· X â¾ X Â· Y. 

recCast2 â—‚ âˆ€ X : ğ’Œ . Cast2 Â· (F Â· X) Â· X â¾ Cast2 Â· Rec2 Â· X =
  Î› X . Î› c . [ Î› Y . Î» d . d Â· X -c , Î² ].

recFold2 â—‚  RecFunctor2 â¾ Cast2 Â· (F Â· Rec2) Â· Rec2 =
  Î› fmap . 
    [ Î› Y . Î» x . Î› X . Î› c .
      cast2 Â· (F Â· X) Â· X -c Â· Y
        (cast2 Â· (F Â· Rec2) Â· (F Â· X)
          -(fmap Â· Rec2 Â· X (recCast2 Â· X -c)) Â· Y x),
      Î² ].

recUnfold2 â—‚  RecFunctor2 â¾ Cast2 Â· Rec2 Â· (F Â· Rec2) =
  Î› fmap . [Î› X . Î» x . x Â· (F Â· Rec2) -(fmap Â· (F Â· Rec2) Â· Rec2 (recFold2 -fmap)) , Î² ].


